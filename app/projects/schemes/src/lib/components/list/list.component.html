<mat-grid-list [cols]="cols"
               gutterSize="20"
               [rowHeight]="aspect"
               infiniteScroll
               [infiniteScrollDistance]="2"
               [infiniteScrollThrottle]="150"
               [infiniteScrollContainer]="'.mat-sidenav-content'"
               [infiniteScrollDisabled]="!isLoading"
               [immediateCheck]="true"
               [fromRoot]="true"
               (scrolled)="onScroll()">
  <mat-grid-tile *ngFor="let scheme of schemes$|async; index as ix; trackBy: trackById">
    <mat-card [tabindex]="100+ix"
              [attr.sid]="scheme.id">
      <mat-card-header>
        <mat-icon mat-card-avatar
                  [matTooltip]="scheme.side === 'dark' ? 'Dark color scheme' : 'Light color scheme'">
          {{scheme.side === 'dark' ? 'brightness_3' : 'wb_sunny'}}
        </mat-icon>
        <a mat-card-title
           [href]="scheme.screenshots[0].urls['1280x800']"
           target="_blank">
          {{scheme.name}}
        </a>
        <span mat-card-subtitle
              [matTooltip]="scheme.publisher.community ? 'Community member' : 'Midnight Lizard team'">
          by {{scheme.publisher.name}}
          <mat-icon color="accent">{{scheme.publisher.community ? 'people' : 'verified_user'}}</mat-icon>
        </span>
        <span fxFlex></span>
        <button mat-icon-button
                #schemeMenuTrigger
                matTooltip="More"
                (menuClosed)="schemeMenuTrigger.focus()"
                [matMenuTriggerFor]="schemeMenu">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #schemeMenu="matMenu"
                  xPosition="before">
          <button mat-menu-item
                  matTooltip="Download color scheme file"
                  matTooltipPosition="left">
            <mat-icon>file_download</mat-icon>
            <span>Download</span>
          </button>
          <button mat-menu-item
                  matTooltip="Share"
                  matTooltipPosition="left">
            <mat-icon>share</mat-icon>
            <span>Share</span>
          </button>
        </mat-menu>
      </mat-card-header>
      <schemes-thumbnails mat-card-image
                          [screenshots]="scheme.screenshots">
      </schemes-thumbnails>
      <mat-card-actions fxLayout="row">
        <button mat-icon-button
                [color]="scheme.liked ? 'accent' : ''"
                [matTooltip]="scheme.liked ? 'Remove like' : 'Add like'"
                (click)="toggleSchemeLiked(scheme)">
          <mat-icon *ngIf="scheme.liked"
                    matBadgeColor="warn"
                    matBadgeSize="small"
                    matBadgeOverlap="true"
                    matBadgePosition="below before"
                    [matBadge]="scheme.likes">thumb_up</mat-icon>
          <mat-icon *ngIf="!scheme.liked"
                    matBadgeColor="warn"
                    matBadgeSize="small"
                    matBadgeOverlap="true"
                    matBadgePosition="below before"
                    svgIcon="outline-thumb-up"
                    [matBadge]="scheme.likes"></mat-icon>
        </button>
        <button mat-icon-button
                [color]="scheme.favorited ? 'warn' : ''"
                [matTooltip]="scheme.favorited ? 'Remove from favorites' : 'Add to favorites'"
                (click)="toggleSchemeFavorited(scheme)">
          <mat-icon>{{scheme.favorited ? "favorite" : "favorite_border"}}</mat-icon>
        </button>
        <span fxFlex></span>
        <button mat-raised-button
                fxFlexAlign="center"
                color="accent"
                class="mat-accent"
                matTooltip="Add into Midnight Lizard extension in your browser">
          Add to browser
        </button>
      </mat-card-actions>
    </mat-card>
  </mat-grid-tile>
</mat-grid-list>